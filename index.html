<!DOCTYPE html>
<html>
<head>
    <title>Google Map with Search Bar</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAa7lEfCZr3gWB9IpWYHYWDzcXHcaEh9ss&libraries=places"></script>
    <style>
        #map2 {
            height: 500px;
            width: 100%;
        }
        #searchInput {
            width: 300px;
            padding: 10px;
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <input id="searchInput" type="text" placeholder="Search location...">
    <div id="map2"></div>

    <script>
        function initMap(latitude = 28.7041, longitude = 77.1025) {
            let map = new google.maps.Map(document.getElementById("map2"), {
                center: { lat: latitude, lng: longitude },
                zoom: 10
            });

            let marker = new google.maps.Marker({
                position: { lat: latitude, lng: longitude },
                map: map
            });

            // üìç Click event to update coordinates
            map.addListener("click", function (event) {
                let lat = event.latLng.lat();
                let lng = event.latLng.lng();

                document.getElementById("latitude").value = lat;
                document.getElementById("longitude").value = lng;

                if (marker) marker.setMap(null);

                marker = new google.maps.Marker({
                    position: event.latLng,
                    map: map
                });
            });

            // üîç Autocomplete search bar
            const input = document.getElementById("searchInput");
            const autocomplete = new google.maps.places.Autocomplete(input);
            autocomplete.bindTo("bounds", map);

            autocomplete.addListener("place_changed", function () {
                const place = autocomplete.getPlace();
                if (!place.geometry) return;

                // Move map to searched location
                if (place.geometry.viewport) {
                    map.fitBounds(place.geometry.viewport);
                } else {
                    map.setCenter(place.geometry.location);
                    map.setZoom(15);
                }

                if (marker) marker.setMap(null);

                marker = new google.maps.Marker({
                    position: place.geometry.location,
                    map: map
                });

                // Update lat/lng fields if present
                if (document.getElementById("latitude"))
                    document.getElementById("latitude").value = place.geometry.location.lat();

                if (document.getElementById("longitude"))
                    document.getElementById("longitude").value = place.geometry.location.lng();
            });
        }

        window.onload = initMap;
    </script>

    <!-- Hidden inputs for lat/lng (optional) -->
    <input type="hidden" id="latitude">
    <input type="hidden" id="longitude">
</body>
</html>
